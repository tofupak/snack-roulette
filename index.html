<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Snack Roulette</title>

<!-- Share Tech Mono -->
<link rel="preconnect" href="https://fonts.googleapis.com">
<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">

<style>
  :root {
    --size: 420px;
    --duration: 2600ms;
    --bg: #6ec6ea; /* blue backdrop */
    --rim: #0f0f0f;
    --label: #111;
    --radius: 14px;
    --font: "Share Tech Mono", monospace; /* ‚Üê use Share Tech Mono everywhere */
  }
  html, body { height:100%; }
  body {
    margin:0; display:flex; align-items:center; justify-content:center; min-height:100dvh;
    background: var(--bg);
    font-family: var(--font);
    letter-spacing: .2px;
  }
  .app { width:min(780px, 94vw); display:grid; gap:18px; text-align:center; }
  h1 { margin:0 0 6px; font-size:34px; letter-spacing:.6px; }
  .wheel-wrap {
    position:relative; width:var(--size); height:var(--size); margin:0 auto 6px;
    filter: drop-shadow(0 12px 24px rgba(0,0,0,.18));
  }
  .pointer {
  position:absolute;
  top:-8px;
  left:50%;
  transform: translateX(-50%);
  width:0; height:0;
  border-left:14px solid transparent;
  border-right:14px solid transparent;
  border-bottom:20px solid #ffffff; 
  filter: drop-shadow(0 2px 2px rgba(0,0,0,.25));
  z-index:2;
}

  .bezel {
    position:absolute; inset:-10px; border-radius:50%;
    background:#fff; box-shadow: inset 0 0 0 8px var(--rim), inset 0 0 0 14px #fff;
    z-index:0;
  }
  canvas {
    width:100%; height:100%; display:block; border-radius:50%;
    transition: transform var(--duration) cubic-bezier(.18,.9,.1,1.05);
    background:#fff;
  }
  .controls { display:grid; gap:10px; }
  textarea {
    width:100%; min-height:110px; padding:12px 14px; border:1px solid rgba(0,0,0,.12);
    border-radius:var(--radius); outline:none; resize:vertical; background:#fff;
    font-family: var(--font);
    font-size:14px;
  }
  button {
    padding:12px 18px; border:none; border-radius:var(--radius); font-weight:800; background:#111; color:#fff; cursor:pointer;
    font-family: var(--font);
  }
  button:disabled { opacity:.6; cursor:not-allowed; }
  .row { display:flex; gap:10px; justify-content:center; flex-wrap:wrap; }
  .tiny { font-size:14px; color:#132; opacity:.9 }
  .result { font-size:22px; font-weight:900; min-height:28px; }
  .options { display:flex; gap:12px; align-items:center; justify-content:center; flex-wrap:wrap; font-size:15px; color:#102; }
  .badge { font-weight:900; background:#fff; padding:4px 10px; border-radius:999px; border:1px solid rgba(0,0,0,.15); }
  .brand { font-size:13px; opacity:.85; }

  .badge{
  border-radius: var(--radius);
  padding: 6px 12px;           /* optional: gives button-like feel */
  border: 1px solid rgba(0,0,0,.15);
  background: #fff;
  font-weight: 900;
}
</style>
</head>
<body>
  <div class="app">
    <h1><span class="badge">Snack Roulette</span></h1>

    <div class="wheel-wrap">
      <div class="pointer"></div>
      <div class="bezel"></div>
      <canvas id="wheel" width="900" height="900" aria-label="Roulette wheel"></canvas>
    </div>

    <div class="controls">
      <textarea id="snacksInput" placeholder="Enter snacks, one per line">Chips
Pocky
Gummies
Seaweed
Chocolate
Nuts
Popcorn
Boba</textarea>

      <div class="options">
        <label><input type="checkbox" id="noRepeat" checked /> Exclude last result</label>
      </div>

      <div class="row">
        <button id="buildBtn">Build Wheel</button>
        <button id="spinBtn" disabled>Spin</button>
      </div>

      <div class="result" id="result"></div>
      <div class="brand tiny">Made by Tofupak</div>
    </div>
  </div>

<script>
  const canvas = document.getElementById('wheel');
  const ctx = canvas.getContext('2d');
  const spinBtn = document.getElementById('spinBtn');
  const buildBtn = document.getElementById('buildBtn');
  const textarea = document.getElementById('snacksInput');
  const resultEl = document.getElementById('result');
  const noRepeatEl = document.getElementById('noRepeat');

  let snacks = [];
  let lastIndex = -1;
  let currentRotation = 0; // degrees (CSS transform)
  const radius = canvas.width / 2;

  const PALETTE = [
    "#f97316", "#22c55e", "#60a5fa", "#a78bfa", "#f59e0b",
    "#ef4444", "#10b981", "#3b82f6", "#f472b6", "#84cc16"
  ];

  function deg2rad(d) { return d * Math.PI / 180; }

  function drawWheel() {
    ctx.clearRect(0,0,canvas.width,canvas.height);
    if (snacks.length < 2) return;

    const n = snacks.length;
    const slice = 360 / n;

    ctx.save();
    ctx.translate(radius, radius);

    for (let i=0;i<n;i++){
      const start = deg2rad(i*slice - 90);
      const end   = deg2rad((i+1)*slice - 90);

      // slice fill
      ctx.beginPath();
      ctx.moveTo(0,0);
      ctx.arc(0,0, radius-24, start, end);
      ctx.closePath();
      ctx.fillStyle = PALETTE[i % PALETTE.length];
      ctx.fill();

      // separator
      ctx.strokeStyle = "rgba(0,0,0,.12)";
      ctx.lineWidth = 2;
      ctx.beginPath();
      ctx.moveTo(0,0);
      ctx.arc(0,0, radius-24, start, end);
      ctx.stroke();

      // label
      const mid = (start + end)/2;
      const labelR = radius - 110;
      ctx.save();
      ctx.rotate(mid);
      ctx.translate(labelR, 0);
      ctx.rotate(Math.PI/2);
      ctx.fillStyle = "#111";
      // use Share Tech Mono for canvas text
      let fontSize = 28, text = snacks[i], maxWidth = 220;
      ctx.font = `700 ${fontSize}px ${getComputedStyle(document.documentElement).getPropertyValue('--font')}`;
      ctx.textAlign = "center"; ctx.textBaseline = "middle";
      while (ctx.measureText(text).width > maxWidth && fontSize > 12) {
        fontSize -= 1;
        ctx.font = `700 ${fontSize}px ${getComputedStyle(document.documentElement).getPropertyValue('--font')}`;
      }
      ctx.fillText(text, 0, 0);
      ctx.restore();
    }

    // center hub
    ctx.beginPath();
    ctx.fillStyle = "#111";
    ctx.arc(0,0, 20, 0, Math.PI*2);
    ctx.fill();

    ctx.restore();
  }

  function rebuild() {
    snacks = textarea.value.split('\n').map(s => s.trim()).filter(Boolean);
    localStorage.setItem('snacks', textarea.value);
    resultEl.textContent = '';
    spinBtn.disabled = snacks.length < 2;
    canvas.style.transform = `rotate(${currentRotation = 0}deg)`;
    drawWheel();
  }

  function spin() {
    if (snacks.length < 2) return;

    const indices = snacks.map((_,i)=>i).filter(i => !(noRepeatEl.checked && i === lastIndex));
    const chosen = indices[Math.floor(Math.random()*indices.length)];
    lastIndex = chosen;

    const n = snacks.length;
    const slice = 360 / n;
    const targetDeg = (6 + Math.floor(Math.random()*3))*360
                    + (360 - (chosen*slice + slice/2));

    currentRotation = targetDeg;
    canvas.style.transform = `rotate(${currentRotation}deg)`;

    resultEl.textContent = '';
    spinBtn.disabled = true;
    setTimeout(() => {
      resultEl.textContent = `‚Üí ${snacks[chosen]} üéâ`;
      spinBtn.disabled = false;
    }, 2700);
  }

  (function init(){
    const saved = localStorage.getItem('snacks');
    const params = new URLSearchParams(location.search);
    const fromURL = params.get('list');
    if (fromURL) textarea.value = decodeURIComponent(fromURL).split('|').join('\n');
    else if (saved) textarea.value = saved;
    rebuild();
  })();

  buildBtn.addEventListener('click', rebuild);
  spinBtn.addEventListener('click', spin);
  window.addEventListener('resize', drawWheel);
</script>
</body>
</html>

